<!DOCTYPE html>
<html lang="en">
<head>
    <title>Chat-Bot</title>
    <link rel="stylesheet" href="chatbot.css">
</head>

<body>

    <div class="root"></div>
    
<script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://unpkg.com/supersimpledev/chatbot.js"></script>

<script type="text/babel">

function ChatBotInput({chatMessages,setChatMessages}){

    const [input,setInput] = React.useState('');

    const inputValue = function(e){
        setInput(e.target.value);
    }

    const runClick = function(){
    
    const newMsg = [...chatMessages,{
        id:crypto.randomUUID(),
        msg: input,
        user : 'user'
      }];

    setChatMessages(newMsg);

    const bot = Chatbot.getResponse(input);
     const botMsg = {
        id:crypto.randomUUID(),
        msg: bot,
        user : 'robot'
      }

    setChatMessages([...newMsg,botMsg]);


    setInput('');
    }

    return (
        <>
        <div className={'input'}>
            <input className={`input-field`} onChange={inputValue} type="text" value={input} placeholder='Send a message to chatbot'/>
            <button className={`send-button`} onClick={runClick}>Enter</button>
        </div>
        </>
    )
}

function ChatMessage({msg,user}){
        return(
            <div className={`message ${user}`}>
            {user === 'robot' && <img width='45px' src="./images/robot.png" alt=""/>}
            <span className={`chatMsg`}>{msg}</span>
            {user === 'user' && <img width='45px' src="./images/user.png" alt=""/>}
            </div>
        )
}

function DynamicChat({chatMessages}){
    const chatRef = React.useRef(null);

    React.useEffect(()=>{
    const containerElem = chatMessages.current;

    if(containerElem){
        containerElem.scrollTop = containerElem.scrollHeight;
    }
    },[chatMessages]);

return(
    <div className='chat-container' ref={chatRef}>
       { chatMessages.map(messages=>(
        <ChatMessage msg={messages.msg} 
            user={messages.user} 
            key={messages.id}
        />
    ))}
    </div>
)
}

function App(){
    const [chatMessages,setChatMessages] = React.useState([
    // {
    //     msg: 'Hey there',
    //     user: 'user',
    //     id : 0
    // },
    // {
    //     msg: 'Yes! how can i help you',
    //     user: 'robot',
    //     id : 1
    // },
    // {
    //     msg: 'Whats the time now in india',
    //     user: 'user',
    //     id : 2
    // },
    // {
    //     msg: 'its 1:55 p.m',
    //     user: 'robot',
    //     id : 3
    // },
    // {
    //     msg: 'who are you?',
    //     user: 'user',
    //     id : 4
    // },
    // {
    //     msg: 'I am simply designed ChatBot here to help you',
    //     user: 'robot',
    //     id : 5
    // },
    // {
    //     msg: 'Ok, Thank You',
    //     user: 'user',
    //     id : 6
    // },
    // {
    //     msg: 'Youre welcome, feel free to ask anything',
    //     user: 'robot',
    //     id : 7
    // },
])

    return(
    <div className="container">

        <DynamicChat chatMessages={chatMessages}/>

        <ChatBotInput chatMessages={chatMessages}
        setChatMessages={setChatMessages}/>

    </div>
    )
}

ReactDOM.createRoot(document.querySelector(".root")).render(<App/>)

</script>
</body>

</html>



